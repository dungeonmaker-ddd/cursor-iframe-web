<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>子应用1</title>
    <!-- 基础样式 -->
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        body {
            background-color: #eff6ff; /* bg-blue-50 的颜色值 */
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        .loading {
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .loaded {
            opacity: 1;
        }
        /* iframe容器样式 */
        #app {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 0.75rem;
            min-height: 0;
            transition: padding 0.3s ease;
        }
        @media (min-width: 640px) {
            #app {
                padding: 1rem;
            }
        }
        @media (min-width: 768px) {
            #app {
                padding: 1.25rem;
            }
        }
        /* iframe样式 */
        #cardLayout {
            flex: 1;
            width: 100%;
            border: none;
            min-height: 0;
            transition: all 0.3s ease;
        }
        /* 加载指示器样式 */
        #loading {
            position: fixed;
            inset: 0;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
        }
        .loading-spinner {
            width: 2.5rem;
            height: 2.5rem;
            border: 2px solid #e5e7eb;
            border-top-color: #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
        /* 内容响应式样式 */
        .content-list {
            font-size: 0.875rem;
            line-height: 1.25rem;
            width: 100%;
            max-width: 768px;
            margin: 0 auto;
        }
        .list-item {
            display: flex;
            align-items: center;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 0.5rem;
            transition: all 0.3s ease;
        }
        .list-item:hover {
            background: rgba(255, 255, 255, 0.8);
            transform: translateX(4px);
        }
        .icon-container {
            width: 24px;
            height: 24px;
            min-width: 24px;
            margin-right: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .item-text {
            flex: 1;
            min-width: 0;
        }
        @media (min-width: 640px) {
            .content-list {
                font-size: 1rem;
                line-height: 1.5rem;
            }
            .list-item {
                padding: 1rem;
                margin-bottom: 0.75rem;
            }
            .icon-container {
                width: 28px;
                height: 28px;
                min-width: 28px;
            }
        }
        @media (min-width: 768px) {
            .content-list {
                font-size: 1.125rem;
                line-height: 1.75rem;
            }
            .list-item {
                padding: 1.25rem;
                margin-bottom: 1rem;
            }
            .icon-container {
                width: 32px;
                height: 32px;
                min-width: 32px;
            }
        }
    </style>
</head>
<body>
    <!-- 加载指示器 -->
    <div id="loading">
        <div class="loading-spinner"></div>
    </div>

    <!-- 主内容区域 -->
    <div id="app" class="loading">
        <!-- 卡片布局组件 -->
        <iframe id="cardLayout" src="../components/card-layout.html"></iframe>
    </div>

    <!-- 应用逻辑 -->
    <script>
        // 准备卡片内容
        const cardContent = `
            <ul class="content-list">
                <li class="list-item">
                    <div class="icon-container">
                        <svg class="text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                    <span class="item-text">完全独立的样式</span>
                </li>
                <li class="list-item">
                    <div class="icon-container">
                        <svg class="text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                    <span class="item-text">独立的HTML结构</span>
                </li>
                <li class="list-item">
                    <div class="icon-container">
                        <svg class="text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                    <span class="item-text">可以单独部署</span>
                </li>
            </ul>
        `;

        // 监听来自主应用的消息
        window.addEventListener('message', function(event) {
            const data = event.data;
            
            // 如果是按钮点击事件，转发给父窗口
            if (data === 'buttonClicked') {
                window.parent.postMessage('buttonClicked', '*');
                return;
            }
            
            if (data.type === 'tailwindLoaded') {
                const app = document.getElementById('app');
                const loading = document.getElementById('loading');
                
                // 显示应用内容
                app.classList.add('loaded');
                loading.style.display = 'none';
            }

            // 监听窗口大小变化
            if (data.type === 'windowResize') {
                // 可以在这里处理响应式逻辑
                console.log('Window resized:', data.width, data.height);
            }
            
            // 监听卡片布局组件就绪
            if (data.type === 'cardLayoutReady') {
                // 更新卡片内容
                const iframe = document.getElementById('cardLayout');
                iframe.contentWindow.postMessage({
                    type: 'updateCard',
                    title: '子应用1',
                    subtitle: '这是独立的子应用1内容',
                    content: cardContent,
                    footerLeft: '<span class="text-gray-500 inline-block min-w-[120px]">更新时间: 2024</span>',
                    footerRight: '<iframe src="../components/button.html" style="width:180px;border:0;overflow:hidden"></iframe>'
                }, '*');
            }
        });
    </script>
</body>
</html> 